# 语法分析功能优化方案：液态聚焦 (Liquid Focus)

针对您反馈的“颜色乱、划线乱”的问题，我设计了一套基于“分层降噪”和“液态美学”的升级方案。核心理念是：**默认简洁，按需深究**。

## 1. 视觉降噪与分层 (Visual De-cluttering & Layering)

目前的痛点是所有成分（主谓宾定状补）一次性全部高亮，导致视觉过载。

*   **默认视图（骨架模式）**：
    *   仅高亮句子的**核心骨架**（主语、谓语、宾语）。
    *   颜色统一为**低饱和度**的色系（如：主语-淡墨绿，谓语-淡绯红，宾语-淡靛蓝），避免刺眼。
    *   样式采用**底部柔光条**（Soft Glow Bar），而非生硬的下划线。
*   **交互视图（透视模式）**：
    *   **悬停聚焦**：当鼠标悬停在某个成分上时，该成分颜色变亮（高饱和度），并呈现“液态流动”效果。
    *   **修饰成分开关**：提供一个“🔍 深度分析”开关。开启后，才显示修饰成分（定语、状语、补语）的高亮，且使用**虚线**或**半透明背景**与核心成分区分。

## 2. 嵌套结构优化 (Nested Structure Optimization)

解决“从句套从句”导致的划线混乱。

*   **层级着色 (Level-based Coloring)**：
    *   不再单纯按词性着色，而是结合层级。主句成分颜色最深，从句颜色变浅，嵌套越深越透明。
*   **括号式标记 (Bracket Highlighting)**：
    *   对于长从句，不再使用整行下划线，而是使用**首尾半包围**的标记（类似 `└─ 从句内容 ─┘` 的视觉隐喻），减少线条重叠。
*   **空间隔离**：
    *   在行间距允许的情况下，将不同层级的下划线在垂直方向上错开（主句在贴近文字处，从句在稍远处）。

## 3. 液态玻璃交互 (Liquid Glass Interaction)

*   **动态气泡 (Dynamic Bubble)**：
    *   点击或悬停语法成分时，不弹出生硬的方框 Tooltip。
    *   在选中文本上方浮现一个**磨砂玻璃质感的气泡**，动态展示该成分的标签（如“定语从句”）和简短解释。
    *   气泡跟随鼠标有轻微的**弹性惯性**。
*   **智能连线**：
    *   在“深度分析”模式下，点击谓语，会自动有一条淡淡的光线连接到其主语和宾语，直观展示逻辑关系。

## 4. 技术实现路径 (Implementation Path)

1.  **重构 `ParagraphCard.tsx`**：
    *   引入 `HighlightLayer` 概念，将高亮分为 `Core` (核心) 和 `Modifier` (修饰) 两层。
    *   重写颜色映射表，使用 Tailwind 的 `opacity` 和 `mix-blend-mode` 实现柔和叠加。
2.  **优化数据解析**：
    *   利用后端返回的 `sentence_tree` 计算每个 token 的嵌套深度 (`depth`)，作为样式渲染的依据。
3.  **UI 组件升级**：
    *   使用 `framer-motion` 添加状态切换时的平滑过渡动画。

这个方案将把“满屏花花绿绿”变成“清爽的文本，灵动的交互”。您觉得这个方向如何？